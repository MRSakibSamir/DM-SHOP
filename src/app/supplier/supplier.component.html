<div class="container my-4">
  <h2 class="mb-4 text-center fw-bold text-primary">
    <i class="bi bi-box-seam"></i> Supplier Management
  </h2>

  <!-- Loading Spinner -->
  <div *ngIf="loading" class="text-center my-5">
    <div class="spinner-border text-primary" role="status"></div>
    <p class="mt-2">Loading suppliers...</p>
  </div>

  <!-- Supplier List -->
  <ul *ngIf="!loading && suppliers.length" class="list-group shadow-sm rounded-3 mb-4">
    <li *ngFor="let s of suppliers" class="list-group-item d-flex justify-content-between align-items-center">
      <div>
        <div class="fw-semibold fs-5">{{ s.name }}</div>
        <div class="small text-muted mb-1">
          <i class="bi bi-envelope"></i> {{ s.contactInfo || 'No contact info' }}
        </div>
        <div class="small">{{ s.description || 'No description provided.' }}</div>
        <div *ngIf="s.categoryId" class="mt-1">
          <span class="badge bg-info text-dark">Category #{{ s.categoryId }}</span>
        </div>
      </div>

      <div class="btn-group">
        <button
          (click)="startEdit(s)"
          class="btn btn-sm btn-outline-primary"
          title="Edit supplier"
        >
          <i class="bi bi-pencil-square"></i> Edit
        </button>
        <button
          (click)="deleteSupplier(s.id)"
          class="btn btn-sm btn-outline-danger"
          title="Delete supplier"
        >
          <i class="bi bi-trash"></i> Delete
        </button>
      </div>
    </li>
  </ul>

  <div *ngIf="!loading && !suppliers.length" class="alert alert-secondary text-center">
    <i class="bi bi-exclamation-circle"></i> No suppliers yet.
  </div>

  <!-- Supplier Form -->
  <div class="card shadow-sm mt-4">
    <div class="card-header bg-primary text-white">
      <h5 class="mb-0">
        <i class="bi" [ngClass]="editing ? 'bi-pencil' : 'bi-plus-circle'"></i>
        {{ editing ? 'Edit Supplier' : 'Create Supplier' }}
      </h5>
    </div>

    <div class="card-body">
      <form [formGroup]="form" (ngSubmit)="save()">
        <div class="mb-3">
          <label class="form-label fw-semibold">Name *</label>
          <input
            class="form-control"
            formControlName="name"
            placeholder="Enter supplier name"
          />
          <div
            *ngIf="form.controls['name'].touched && form.controls['name'].invalid"
            class="text-danger small mt-1"
          >
            Name is required and must be shorter than 255 characters.
          </div>
        </div>

        <div class="mb-3">
          <label class="form-label fw-semibold">Contact Info</label>
          <input
            class="form-control"
            formControlName="contactInfo"
            placeholder="Email, phone, etc."
          />
        </div>

        <div class="mb-3">
          <label class="form-label fw-semibold">Description</label>
          <textarea
            class="form-control"
            rows="3"
            formControlName="description"
            placeholder="Brief supplier description..."
          ></textarea>
        </div>

        <div class="mb-3">
          <label class="form-label fw-semibold">Category ID (optional)</label>
          <input
            type="number"
            class="form-control"
            formControlName="categoryId"
            placeholder="Enter category ID"
          />
        </div>

        <div class="d-flex justify-content-end gap-2">
          <button type="submit" class="btn btn-success">
            <i class="bi bi-check-circle"></i> Save
          </button>
          <button type="button" (click)="cancel()" class="btn btn-secondary">
            <i class="bi bi-x-circle"></i> Cancel
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
